<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Holy Item - Digital Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #e3e0db; color: #444; margin: 0; }
        h1, h2, h3, h4 { font-family: 'Playfair Display', serif; }
        .sidebar-item { transition: all 0.2s; cursor: pointer; opacity: 0.6; display: flex; flex-direction: column; align-items: center; padding: 12px 0; width: 100%; }
        .sidebar-item:hover { opacity: 1; background: rgba(255,255,255,0.05); }
        .active-tab { opacity: 1; background: rgba(255,255,255,0.1); border-radius: 12px; }
        textarea, input { background: transparent; border: none; outline: none; width: 100%; resize: none; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); }
        .day-card { aspect-ratio: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 0.5px solid #f0f0f0; cursor: pointer; transition: 0.2s; position: relative; font-size: 0.8rem; }
        .today { background: #333; color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; }
        .has-content::after { content: ''; position: absolute; bottom: 4px; width: 4px; height: 4px; background: #8a817c; border-radius: 50%; }
        .offline-banner { display: none; background: #fee2e2; color: #991b1b; text-align: center; padding: 8px; font-size: 12px; font-weight: bold; width: 100%; position: sticky; top: 0; z-index: 50; }
        @media (max-width: 768px) {
            .main-container { flex-direction: column; height: auto; }
            .sidebar { width: 100%; height: auto; flex-direction: row; padding: 10px; overflow-x: auto; }
            .sidebar-item { width: auto; padding: 10px 15px; }
            .sidebar-item span:last-child { display: none; }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-0 md:p-4">

    <div id="offline-msg" class="offline-banner">‚ö†Ô∏è No tienes conexi√≥n a internet. Los cambios no podr√°n ser guardados en la nube (solo localmente).</div>

    <div class="w-full max-w-6xl bg-[#fcfcfc] md:rounded-[2.5rem] shadow-2xl flex flex-col md:flex-row min-h-[90vh] overflow-hidden border border-stone-200 main-container">
        
        <nav class="sidebar w-24 bg-[#1a1a1a] flex flex-col items-center py-6 justify-between text-white shrink-0">
            <div class="flex flex-col md:flex-col items-center gap-2 md:gap-4 w-full px-2">
                <div class="hidden md:flex w-14 h-14 bg-[#333] rounded-full items-center justify-center font-bold text-xs tracking-tighter border border-stone-600 mb-2">THI</div>
                
                <div onclick="showTab('mes')" id="nav-mes" class="sidebar-item active-tab"><span class="text-xl">üìÖ</span><span class="text-[9px] font-bold mt-1">MES</span></div>
                <div onclick="showTab('dia')" id="nav-dia" class="sidebar-item"><span class="text-xl">üìù</span><span class="text-[9px] font-bold mt-1">D√çA</span></div>
                <div onclick="showTab('pendientes')" id="nav-pendientes" class="sidebar-item"><span class="text-xl">üìã</span><span class="text-[9px] font-bold mt-1">PENDIENTES</span></div>
                <div onclick="showTab('nazareth')" id="nav-nazareth" class="sidebar-item"><span class="text-xl">üè†</span><span class="text-[9px] font-bold mt-1">NAZARETH</span></div>
                <div onclick="showTab('luces')" id="nav-luces" class="sidebar-item"><span class="text-xl">‚ú®</span><span class="text-[9px] font-bold mt-1">LUCES</span></div>
                <div onclick="showTab('oracion')" id="nav-oracion" class="sidebar-item"><span class="text-xl">üôè</span><span class="text-[9px] font-bold mt-1">ORACI√ìN</span></div>
                <div onclick="showTab('bienestar')" id="nav-bienestar" class="sidebar-item"><span class="text-xl">üåø</span><span class="text-[9px] font-bold mt-1">BIENESTAR</span></div>
                <div onclick="showTab('notas')" id="nav-notas" class="sidebar-item"><span class="text-xl">üìñ</span><span class="text-[9px] font-bold mt-1">NOTAS</span></div>
            </div>
        </nav>

        <main class="flex-1 p-4 md:p-10 overflow-y-auto bg-[#faf9f6]" id="main-scroll">
            <div id="view-container"></div>
        </main>
    </div>

    <footer class="mt-4 pb-6 text-stone-500 text-[10px] tracking-[0.2em] uppercase text-center">
        Digital Planner by <span class="font-bold">The Holy Item</span> ¬©
    </footer>

    <script>
        // --- BASE DE DATOS DE FRASES (104) ---
        const weeklyQuotes = [
            "\"Dios se da a nosotros en la medida en que nosotros esperamos en √âl.\" ‚Äì Jacques Philippe",
            "\"La medida del amor es amar sin medida.\" ‚Äì San Agust√≠n",
            "\"La oraci√≥n es el ox√≠geno del alma.\" ‚Äì Padre P√≠o",
            "\"Dios nunca dijo que el camino ser√≠a f√°cil, pero s√≠ dijo que la llegada valdr√≠a la pena.\" ‚Äì Max Lucado",
            "\"La gloria de Dios es el hombre plenamente vivo.\" ‚Äì San Ireneo",
            "\"D√©jate llevar por las manos de Dios y nunca perder√°s el rumbo de tu vida.\" ‚Äì An√≥nimo",
            "\"La santidad no est√° hecha de algunos actos heroicos, sino de mucho amor cotidiano.\" ‚Äì Papa Francisco",
            "\"No busques qu√© dar. Date a ti mismo.\" ‚Äì San Agust√≠n",
            "\"La paz no es la ausencia de problemas, sino la presencia de Dios.\" ‚Äì Jacques Philippe",
            "\"√âl quiere tomar tu vida, para ofrecerte la suya.\" ‚Äì Santa Teresa Benedicta de la Cruz",
            "\"Dios tiene un plan que lleva tu nombre.\" ‚Äì An√≥nimo",
            "\"Lo que se necesita para conseguir la felicidad, no es una vida c√≥moda, sino un coraz√≥n enamorado.\" ‚Äì San Josemar√≠a Escriv√°",
            "\"Hay una enorme diferencia entre 'haz lo posible' y 'hazlo posible', la primera depende de ti, la segunda de Dios y √âl todo lo puede.\" ‚Äì An√≥nimo",
            "\"Dios ha escrito para cada uno de nosotros una historia √∫nica e irrepetible, pero nos ha dejado la libertad de escribir la conclusi√≥n.\" ‚Äì San Carlo Acutis",
            "\"Si juzgas a la gente, no tienes tiempo para amarla.\" ‚Äì Madre Teresa de Calcuta",
            "\"No existen l√≠mites para quien tiene fe en Dios.\" ‚Äì An√≥nimo",
            "\"Le haces un cumplido a Dios cuando le pides cosas grandes.\" ‚Äì Santa Teresa de √Åvila",
            "\"La fe es creer lo que no ves; la recompensa es ver lo que crees.\" ‚Äì San Agust√≠n",
            "\"La vida con Dios no es inmunidad frente a las dificultades, sino paz en medio de ellas.\" ‚Äì C. S. Lewis",
            "\"No te inquietes por el ma√±ana; Dios ya est√° all√≠ esper√°ndote.\" ‚Äì Jacques Philippe",
            "\"Reza como si todo dependiera de Dios. Trabaja como si todo dependiera de ti.\" ‚Äì San Agust√≠n",
            "\"La humildad es aceptar con alegr√≠a ser lo que somos ante los ojos de Dios.\" ‚Äì Jacques Philippe",
            "\"A veces Dios no cambia las circunstancias porque est√° usando las circunstancias para cambiarte a ti.\" ‚Äì An√≥nimo",
            "\"La fe es un salto a la oscuridad de las manos de Dios.\" ‚Äì S√∏ren Kierkegaard",
            "\"Difunde el amor dondequiera que vayas.\" ‚Äì Madre Teresa de Calcuta",
            "\"Dios no nos necesita, pero nos quiso.\" ‚Äì Rick Warren",
            "\"La medida de nuestra paz interior depende de nuestra confianza en Dios.\" ‚Äì Jacques Philippe",
            "\"No importa a lo que te enfrentes en la vida, nunca te sueltes de la mano de Dios.\" ‚Äì An√≥nimo",
            "\"Nada te turbe, nada te espante, todo se pasa, Dios no se muda.\" ‚Äì Santa Teresa de √Åvila",
            "\"Sin la paz del coraz√≥n, no podemos hacer nada bueno.\" ‚Äì Jacques Philippe",
            "\"Dios sabe en qu√© tiempo entregarte cada cosa que pides.\" ‚Äì An√≥nimo",
            "\"El amor es la llave que abre todas las puertas.\" ‚Äì San Vicente de Pa√∫l",
            "\"Yo puedo hacer cosas que t√∫ no puedes, t√∫ puedes hacer cosas que yo no puedo; juntos podemos hacer grandes cosas.\" ‚Äì Madre Teresa de Calcuta",
            "\"La oraci√≥n no es para cambiar a Dios, sino para cambiarnos a nosotros mismos.\" ‚Äì C. S. Lewis",
            "\"El camino m√°s corto para llegar a la santidad es aceptar lo que Dios nos env√≠a hoy.\" ‚Äì Jacques Philippe",
            "\"La gloria del Se√±or brilla sobre ti; lev√°ntate y resplandece.\" ‚Äì An√≥nimo",
            "\"Si Dios es tu socio, haz planes en grande.\" ‚Äì D. L. Moody",
            "\"Aceptar nuestra propia debilidad es la puerta abierta a la fuerza de Dios.\" ‚Äì Jacques Philippe",
            "\"Dios conoce lo m√°s profundo de nuestro ser; es √âl quien lo ha modelado con sus propias manos.\" ‚Äì An√≥nimo",
            "\"No todos podemos hacer grandes cosas, pero s√≠ cosas peque√±as con gran amor.\" ‚Äì Madre Teresa de Calcuta",
            "\"La fe es aceptar que Dios nos ama incluso cuando no nos sentimos amables.\" ‚Äì Jacques Philippe",
            "\"Dios no te hubiera dado la capacidad de so√±ar sin darte tambi√©n la posibilidad de convertir tus sue√±os en realidad.\" ‚Äì An√≥nimo",
            "\"Nunca tengas miedo de confiar un futuro desconocido a un Dios conocido.\" ‚Äì Corrie ten Boom",
            "\"Nuestra √∫nica tarea es mantener el coraz√≥n abierto a la gracia.\" ‚Äì Jacques Philippe",
            "\"La verdadera fe no se encuentra en el entendimiento, sino en el coraz√≥n.\" ‚Äì Blaise Pascal",
            "\"Tu lucha silenciosa hace ruido en el cielo.\" ‚Äì Padre P√≠o",
            "\"Quien tiene paz en su interior lo tiene todo, aunque le falte lo material.\" ‚Äì Jacques Philippe",
            "\"Dios, gracias por mantenerme de pie, aun cuando a veces todo parece caer en pedazos.\" ‚Äì An√≥nimo",
            "\"El grado de libertad de una persona se mide por su capacidad de amar.\" ‚Äì Jacques Philippe",
            "\"Si puedes, entiende; si no puedes, cree.\" ‚Äì Santo Tom√°s de Aquino",
            "\"No te das cuenta de que Jes√∫s es todo lo que necesitas hasta que Jes√∫s es todo lo que tienes.\" ‚Äì Tim Keller",
            "\"El amor de Dios es fiel; √âl nunca abandona la obra de sus manos.\" ‚Äì Jacques Philippe",
            "\"La esperanza es el sue√±o del hombre despierto.\" ‚Äì Arist√≥teles",
            "\"Todo lo que est√° bajo el control de Dios nunca est√° fuera de control.\" ‚Äì Charles R. Swindoll",
            "\"La verdadera felicidad no est√° en las circunstancias, sino en la uni√≥n con Dios.\" ‚Äì Jacques Philippe",
            "\"Bienaventurados los corazones flexibles, porque no se romper√°n.\" ‚Äì San Francisco de Sales",
            "\"Camina con los pies en la tierra, pero con la mirada y el coraz√≥n en el cielo.\" ‚Äì San Juan Bosco",
            "\"Confiar en Dios significa creer que √âl puede sacar un bien incluso de nuestros errores.\" ‚Äì Jacques Philippe",
            "\"La tierra no tiene ninguna tristeza que el cielo no pueda curar.\" ‚Äì Santo Tom√°s Moro",
            "\"La oraci√≥n es el tiempo donde dejamos que Dios nos ame.\" ‚Äì Jacques Philippe",
            "\"Porque si estamos locos, es para Dios.\" ‚Äì San Francisco de As√≠s",
            "\"No dejes que termine el d√≠a sin haber crecido un poco m√°s.\" ‚Äì An√≥nimo",
            "\"No busques la paz fuera de ti; la paz es un don que Dios deposita en tu alma.\" ‚Äì Jacques Philippe",
            "\"La vida es tu nav√≠o, no tu morada.\" ‚Äì Santa Teresita del Ni√±o Jes√∫s",
            "\"Un hombre no puede ser m√°s hombre que cuando est√° de rodillas ante Dios.\" ‚Äì San Juan XXIII",
            "\"Dios se propone darnos lo que necesitamos, no lo que creemos necesitar ahora.\" ‚Äì C. S. Lewis",
            "\"No importa lo que est√© sucediendo en tu vida, Dios ya tiene algo perfecto para ti.\" ‚Äì An√≥nimo",
            "\"El futuro es tan brillante como las premesas de Dios.\" ‚Äì William Carey",
            "\"No tengas miedo, conf√≠a en Dios.\" ‚Äì Papa Francisco",
            "\"Quien a Dios tiene, nada le falta: solo Dios basta.\" ‚Äì Santa Teresa de √Åvila",
            "\"Dale a la gente una segunda oportunidad. Basta una persona buena para que haya esperanza.\" ‚Äì Papa Francisco",
            "\"La paz comienza con una sonrisa.\" ‚Äì Madre Teresa de Calcuta",
            "\"Dios ama a cada uno de nosotros como si solo existiera uno.\" ‚Äì San Agust√≠n",
            "\"El coraz√≥n tiene razones que la raz√≥n no entiende.\" ‚Äì Blaise Pascal",
            "\"Nunca dejes que las opiniones de los dem√°s derrumben lo que Dios piensa de ti.\" ‚Äì An√≥nimo",
            "\"Donde hay caridad y amor, all√≠ est√° Dios.\" ‚Äì San Juan de la Cruz",
            "\"A veces Dios usa las circunstancias para cambiarte a ti.\" ‚Äì An√≥nimo",
            "\"Para llegar a lo que no eres, has de ir por donde no eres.\" ‚Äì San Juan de la Cruz",
            "\"La fe mueve monta√±as; el amor mueve fronteras.\" ‚Äì An√≥nimo",
            "\"Al atardecer de la vida, nos examinar√°n en el amor.\" ‚Äì San Juan de la Cruz",
            "\"Dios tiene grandes cosas para tu vida, solamente cree.\" ‚Äì An√≥nimo",
            "\"El que no vive para servir, no sirve para vivir.\" ‚Äì San Juan Pablo II",
            "\"Tu talento es un regalo de Dios para ti; lo que hagas con √©l es tu regalo para Dios.\" ‚Äì Leo Buscaglia",
            "\"La verdadera libertad es el poder de hacer lo que debemos hacer.\" ‚Äì C. S. Lewis",
            "\"Dios es el √∫nico que puede llenar el vac√≠o del alma.\" ‚Äì San Agust√≠n",
            "\"Ama hasta que te duela. Si te duele, es buena se√±al.\" ‚Äì Madre Teresa de Calcuta",
            "\"La cruz es la escalera al cielo.\" ‚Äì Santa Rosa de Lima",
            "\"Dios no elige a los preparados, √âl prepara a los elegidos.\" ‚Äì An√≥nimo",
            "\"Busca a Dios en todas las cosas y lo encontrar√°s en ti mismo.\" ‚Äì San Ignacio de Loyola",
            "\"Todo para la mayor gloria de Dios.\" ‚Äì San Ignacio de Loyola",
            "\"El amor es la fuerza m√°s poderosa del mundo.\" ‚Äì San Francisco de As√≠s",
            "\"Predica el Evangelio en todo momento, y si es necesario, usa palabras.\" ‚Äì San Francisco de As√≠s",
            "\"El sufrimiento compartido es sufrimiento disminuido.\" ‚Äì C. S. Lewis",
            "\"Mirad a las estrellas, pero no olvid√©is que vuestro hogar est√° en Dios.\" ‚Äì C. S. Lewis",
            "\"La paciencia todo lo alcanza.\" ‚Äì Santa Teresa de √Åvila",
            "\"Si tienes a Dios, lo tienes todo.\" ‚Äì San Cipriano",
            "\"La oraci√≥n es el arma de los valientes.\" ‚Äì Padre P√≠o",
            "\"Reza, espera y no te preocupes.\" ‚Äì Padre P√≠o",
            "\"Dios te ama tal como eres, pero te ama demasiado para dejarte as√≠.\" ‚Äì C. S. Lewis",
            "\"No hay lugar tan oscuro donde la luz de Dios no pueda llegar.\" ‚Äì An√≥nimo",
            "\"Si pones a Dios en el centro, todo lo dem√°s encontrar√° su lugar.\" ‚Äì An√≥nimo",
            "\"Dios es el arquitecto de tu destino, conf√≠a en sus planos.\" ‚Äì An√≥nimo",
            "\"Solo Dios sabe cu√°nto te ama, y solo √âl puede saciar tu sed de infinito.\" ‚Äì San Juan Pablo II",
            "\"Tu vida es el mensaje que Dios env√≠a al mundo; aseg√∫rate de que sea hermoso.\" ‚Äì An√≥nimo"
        ];

        // --- L√ìGICA DE FECHAS Y ESTADO ---
        let viewDate = new Date();
        let selectedDate = new Date();
        const months = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];

        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);

        function updateOnlineStatus() {
            document.getElementById('offline-msg').style.display = navigator.onLine ? 'none' : 'block';
        }

        function getWeekQuote(date) {
            const start = new Date(2024, 0, 1);
            const diff = date - start;
            const weekNumber = Math.floor(diff / (1000 * 60 * 60 * 24 * 7));
            return weeklyQuotes[Math.abs(weekNumber) % weeklyQuotes.length];
        }

        // --- GESTI√ìN DE DATOS ---
        function getDayData(date) {
            const key = `day-${date.toISOString().split('T')[0]}`;
            const data = localStorage.getItem(key);
            return data ? JSON.parse(data) : { tasks: "", events: [], luces: [], examen: ["","","","",""], wellness: { sleep: 0, water: 0, mobility: 0, nature: 0 }, prayer: { checks: [], message: "" }, nazareth: { hogar: "", trabajo: "", hogarOffer: "", trabajoOffer: "" } };
        }

        function saveDayData(date, data) {
            const key = `day-${date.toISOString().split('T')[0]}`;
            localStorage.setItem(key, JSON.stringify(data));
        }

        // --- VISTAS ---
        function showTab(tab) {
            const container = document.getElementById('view-container');
            document.querySelectorAll('.sidebar-item').forEach(el => el.classList.remove('active-tab'));
            const navEl = document.getElementById('nav-' + tab);
            if(navEl) navEl.classList.add('active-tab');

            if (tab === 'mes') renderMonthView(container);
            else if (tab === 'dia') renderDayView(container);
            else if (tab === 'pendientes') renderGlobalPendientes(container);
            else if (tab === 'nazareth') renderNazarethView(container);
            else if (tab === 'luces') renderLucesView(container);
            else if (tab === 'oracion') renderPrayerGlobalView(container);
            else if (tab === 'bienestar') renderWellnessGlobalView(container);
            else renderNotesView(container);
            
            updateOnlineStatus();
        }

        function renderMonthView(container) {
            const monthName = months[viewDate.getMonth()];
            container.innerHTML = `
                <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                    <h2 class="text-3xl md:text-4xl text-stone-800">${monthName} <span class="text-stone-300">${viewDate.getFullYear()}</span></h2>
                    <div class="flex gap-4 text-2xl text-stone-400">
                        <button onclick="changeMonth(-1)">‚Äπ</button><button onclick="changeMonth(1)">‚Ä∫</button>
                    </div>
                </div>
                <p class="text-[10px] uppercase tracking-widest text-stone-400 mb-4 italic text-center border-y border-stone-100 py-2">
                    Frase de la semana: ${getWeekQuote(viewDate)}
                </p>
                <div class="grid grid-cols-7 mb-2 text-[10px] font-bold text-stone-400 tracking-widest text-center">
                    <div>DOM</div><div>LUN</div><div>MAR</div><div>MI√â</div><div>JUE</div><div>VIE</div><div>S√ÅB</div>
                </div>
                <div class="calendar-grid bg-white rounded-2xl shadow-sm overflow-hidden border border-stone-100">
                    ${generateCalendarHtml()}
                </div>
            `;
        }

        function generateCalendarHtml() {
            let html = '';
            const year = viewDate.getFullYear();
            const month = viewDate.getMonth();
            const firstDayIndex = new Date(year, month, 1).getDay();
            const lastDay = new Date(year, month + 1, 0).getDate();
            for (let x = firstDayIndex; x > 0; x--) html += `<div class="day-card text-stone-200 bg-stone-50/30"></div>`;
            for (let i = 1; i <= lastDay; i++) {
                const d = new Date(year, month, i);
                const key = `day-${d.toISOString().split('T')[0]}`;
                const data = localStorage.getItem(key);
                const isToday = new Date().toDateString() === d.toDateString();
                html += `<div onclick="selectDate(${year}, ${month}, ${i})" class="day-card text-stone-500 ${data ? 'has-content' : ''}"><span class="${isToday ? 'today' : ''}">${i}</span></div>`;
            }
            return html;
        }

        function renderDayView(container) {
            const data = getDayData(selectedDate);
            const dateStr = `${selectedDate.getDate()} de ${months[selectedDate.getMonth()]}`;
            container.innerHTML = `
                <div class="mb-6">
                    <h2 class="text-3xl text-stone-800 italic">${dateStr}</h2>
                    <p class="text-xs text-stone-400 mt-2 italic">"${getWeekQuote(selectedDate)}"</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-3xl border border-stone-100 shadow-sm">
                        <h3 class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-4">Pendientes</h3>
                        <textarea oninput="updateField('tasks', this.value)" class="h-48 leading-relaxed" placeholder="- Tarea importante...">${data.tasks}</textarea>
                    </div>
                    <div class="bg-white p-6 rounded-3xl border border-stone-100 shadow-sm">
                        <h3 class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-4">Eventos con Horario</h3>
                        <div id="events-list" class="space-y-3 mb-4">
                            ${renderEvents(data.events)}
                        </div>
                        <div class="flex gap-2">
                            <input id="event-time" type="time" class="w-24 text-xs border border-stone-100 rounded p-1">
                            <input id="event-title" type="text" class="flex-1 text-xs border border-stone-100 rounded p-1" placeholder="Nombre del evento">
                            <button onclick="addEvent()" class="bg-stone-800 text-white px-3 py-1 rounded text-xs">Add</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderEvents(events) {
            if(!events || events.length === 0) return '<p class="text-[10px] text-stone-300">No hay eventos hoy.</p>';
            return events.map((ev, idx) => {
                const gCalLink = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(ev.title)}&dates=${selectedDate.toISOString().replace(/-|:|\.\d\d\d/g,"")}/${selectedDate.toISOString().replace(/-|:|\.\d\d\d/g,"")}`;
                return `
                <div class="flex justify-between items-center bg-stone-50 p-2 rounded-xl">
                    <span class="text-[10px] font-bold text-stone-400 w-12">${ev.time}</span>
                    <span class="flex-1 text-xs text-stone-700 font-medium">${ev.title}</span>
                    <div class="flex gap-2">
                        <a href="${gCalLink}" target="_blank" title="Sincronizar con GCal" class="opacity-30 hover:opacity-100">üîó</a>
                        <button onclick="deleteEvent(${idx})" class="text-red-200 hover:text-red-500">‚úï</button>
                    </div>
                </div>`;
            }).join('');
        }

        function addEvent() {
            const time = document.getElementById('event-time').value;
            const title = document.getElementById('event-title').value;
            if(!time || !title) return;
            const data = getDayData(selectedDate);
            data.events.push({time, title});
            data.events.sort((a,b) => a.time.localeCompare(b.time));
            saveDayData(selectedDate, data);
            renderDayView(document.getElementById('view-container'));
        }

        function deleteEvent(idx) {
            const data = getDayData(selectedDate);
            data.events.splice(idx, 1);
            saveDayData(selectedDate, data);
            renderDayView(document.getElementById('view-container'));
        }

        function renderNazarethView(container) {
            const data = getDayData(selectedDate);
            container.innerHTML = `
                <div class="max-w-4xl mx-auto text-center space-y-6">
                    <h2 class="text-2xl font-bold tracking-[0.2em] text-stone-800">MI NAZARETH üè†</h2>
                    <p class="text-[11px] font-bold text-stone-500 leading-relaxed max-w-2xl mx-auto border-y border-stone-200 py-4 px-2">
                        ‚ÄúLAVAR UN PLATO NO PORQUE AMES LAVARLO, SINO PORQUE AMAS A LA PERSONA QUE LO USAR√Å DESPU√âS. EL AMOR NOS HACE CAPACES DE AMAR A OTROS DE FORMA ANTICIPADA, NOS HACE RECORRER CAMINOS CON PROP√ìSITO Y HALLAR ESPERANZA EN SITUACIONES TEDIOSAS QUE EN EL PRESENTE MOMENTO QUIZ√ÅS NO LA LLEVEN CONSIGO.‚Äù
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 text-left mt-8">
                        <div class="bg-white p-6 rounded-3xl shadow-sm border border-stone-100">
                            <h3 class="text-xs font-bold text-stone-400 uppercase mb-4">Tareas del Hogar</h3>
                            <textarea oninput="updateNazareth('hogar', this.value)" class="h-32 mb-4 border-b border-stone-50" placeholder="Ej: Limpiar la cocina...">${data.nazareth.hogar || ""}</textarea>
                            <label class="text-[10px] font-bold text-stone-300 block mb-1 uppercase">¬øA qui√©n amo o por qui√©n ofrezco?</label>
                            <input oninput="updateNazareth('hogarOffer', this.value)" type="text" class="text-xs italic text-stone-500" placeholder="Escribe aqu√≠..." value="${data.nazareth.hogarOffer || ""}">
                        </div>
                        <div class="bg-white p-6 rounded-3xl shadow-sm border border-stone-100">
                            <h3 class="text-xs font-bold text-stone-400 uppercase mb-4">Trabajo</h3>
                            <textarea oninput="updateNazareth('trabajo', this.value)" class="h-32 mb-4 border-b border-stone-50" placeholder="Ej: Reportes...">${data.nazareth.trabajo || ""}</textarea>
                            <label class="text-[10px] font-bold text-stone-300 block mb-1 uppercase">¬øA qui√©n amo o por qui√©n ofrezco?</label>
                            <input oninput="updateNazareth('trabajoOffer', this.value)" type="text" class="text-xs italic text-stone-500" placeholder="Escribe aqu√≠..." value="${data.nazareth.trabajoOffer || ""}">
                        </div>
                    </div>
                    <div class="mt-12 p-8 bg-stone-50 rounded-[2rem] border border-stone-200">
                        <h4 class="text-sm font-bold text-stone-600 mb-4 tracking-widest uppercase">Oraci√≥n a la Sagrada Familia de Nazareth</h4>
                        <p class="text-xs md:text-sm text-stone-500 italic leading-relaxed text-left max-w-xl mx-auto">
                            Querid√≠sima Sagrada Familia, que es tambi√©n m√≠a. P√≥nganme en medio de ustedes en ese hogar de amor. Ay√∫denme a transformar en mi vida lo ordinario en extraordinario, lo terreno en divino; la carga en ofrenda, la monoton√≠a en contemplaci√≥n, la presencia en don, las preocupaciones en oraci√≥n, la gratitud en alabanza, la peque√±ez en grandeza y la sobremesa en palabra de Dios.<br><br>
                            Que sea capaz de darme cuenta que es ah√≠, en medio de las cosas m√°s sencillas, que el cielo y la tierra conviven. Les pido hagan de mi hogar un Nazareth. <br>
                            <span class="font-bold block mt-2">Am√©n</span>
                        </p>
                    </div>
                </div>
            `;
        }

        function renderGlobalPendientes(container) {
            const currentMonth = viewDate.getMonth();
            const currentYear = viewDate.getFullYear();
            let tasksHtml = '';
            let eventsHtml = '';
            for(let i=1; i<=31; i++) {
                const d = new Date(currentYear, currentMonth, i);
                if(d.getMonth() !== currentMonth) break;
                const data = getDayData(d);
                if(data.tasks) {
                    tasksHtml += `<div class="mb-4"><span class="text-[9px] font-bold text-stone-400 block">${i} de ${months[currentMonth]}</span><p class="text-xs text-stone-600 whitespace-pre-wrap">${data.tasks}</p></div>`;
                }
                if(data.events && data.events.length > 0) {
                    data.events.forEach(ev => {
                        eventsHtml += `<div class="flex gap-2 text-xs mb-2 items-center"><span class="font-bold text-stone-400">${i}/${currentMonth+1}</span><span class="text-stone-300">${ev.time}</span><span class="text-stone-700">${ev.title}</span></div>`;
                    });
                }
            }
            container.innerHTML = `
                <h2 class="text-3xl text-stone-800 mb-8">Resumen del Mes</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                    <div class="bg-white p-6 rounded-3xl shadow-sm border border-stone-100">
                        <h3 class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-4">Todos los Pendientes</h3>
                        ${tasksHtml || '<p class="text-xs text-stone-300">No hay pendientes registrados.</p>'}
                    </div>
                    <div class="bg-stone-50 p-6 rounded-3xl shadow-sm border border-stone-100">
                        <h3 class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-4">Agenda de Eventos</h3>
                        ${eventsHtml || '<p class="text-xs text-stone-300">No hay eventos este mes.</p>'}
                    </div>
                </div>
            `;
        }

        function updateField(field, value) {
            const data = getDayData(selectedDate);
            data[field] = value;
            saveDayData(selectedDate, data);
        }

        function updateNazareth(field, value) {
            const data = getDayData(selectedDate);
            data.nazareth[field] = value;
            saveDayData(selectedDate, data);
        }

        function changeMonth(offset) { viewDate.setMonth(viewDate.getMonth() + offset); showTab('mes'); }
        function selectDate(y, m, d) { selectedDate = new Date(y, m, d); showTab('dia'); }

        function renderNotesView(c) { 
            const saved = localStorage.getItem('global-notes') || "";
            c.innerHTML = `<h2 class="text-4xl text-stone-800 mb-6 font-serif">Notas generales üìñ</h2><textarea oninput="localStorage.setItem('global-notes', this.value)" class="bg-white p-8 rounded-3xl min-h-[500px] shadow-sm text-stone-600 leading-relaxed" placeholder="Ideas y proyectos...">${saved}</textarea>`; 
        }
        function renderLucesView(c) { c.innerHTML = '<h2 class="text-4xl">Mis Luces ‚ú®</h2><p class="mt-4 text-stone-400">Las luces se cargan desde los d√≠as...</p>'; }
        function renderPrayerGlobalView(c) { c.innerHTML = '<h2 class="text-4xl">Oraci√≥n üôè</h2>'; }
        function renderWellnessGlobalView(c) { c.innerHTML = '<h2 class="text-4xl">Bienestar üåø</h2>'; }

        showTab('mes');
    </script>
</body>
</html>
